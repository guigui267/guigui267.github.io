var n=Object.defineProperty;var o=(a,e,t)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var l=(a,e,t)=>(o(a,typeof e!="symbol"?e+"":e,t),t);import{G as p,b as h,P as u}from"./examples.5f2b840c.js";class c{constructor(){l(this,"panelsVisible",!1);this.initArrayFunc(),this.initData(),this._initGroups()}initData(){this.particleGroup=[],this.particleNum=0,this.particleAnimateData=[]}initArrayFunc(){Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)}}_initGroups(){this.particleModelGroup=new p,this.particleModelGroup.name="\u7C92\u5B50\u7BA1\u7406\u5668\u7EC4"}getParticleAnimation(e){e&&e.traverse(t=>{if(t.isPoints&&t.styleType=="particle"){let i;t.system.name!=null&&t.system.name!=""?i=t.system.name:(i=`\u7C92\u5B50\u52A8\u753B${this.particleNum}`,this.particleNum++),t.system.name=i,this.particleGroup.push(t.system)}})}addParticle(e){e.name==""&&!e.name&&(e.name=`\u7C92\u5B50\u52A8\u753B${this.particleNum}`,this.particleNum++),this.particleGroup.push(e),this.particleModelGroup.add(e.mesh)}getState(){if(this.particleGroup.length>0)for(let e=0;e<this.particleGroup.length;e++)console.log(this.particleGroup[e]);else console.warn("\u5F53\u524D\u573A\u666F\u5185\u90E8\u6CA1\u6709\u52A8\u753B\u3002\u3002\u3002\u3002\u3002\u3002")}update(e){for(let t=0;t<this.particleGroup.length;t++)this.particleGroup[t].update(e)}initGUI(){this.gui=new h}set nameFolder(e){this.parentGUI.domElement.innerText=e}showPanel(){this.initGUI(),this.parentGUI=this.gui.addFolder("\u52A8\u753B\u7BA1\u7406\u5668");for(let e=0;e<this.particleGroup.length;e++)this.addPanelList(this.parentGUI,this.particleGroup[e]);this.panelsVisible=!0,document.getElementsByClassName("dg ac")[0].style.zIndex=1e5}addPanelList(e,t){const i={obs:t,state:t.state,name:t.name,showPanel:!1},s=e.addFolder(i.name);s.add(i,"state").name(`${i.name}\u52A8\u753B`).onChange(r=>{i.obs.state=r}),s.add(i,"showPanel").name(`${i.name}\u7684\u63A7\u5236\u9762\u677F`).onChange(r=>{r?i.obs.showPanel():i.obs.destroyPanel()}),s.add(this,"clearOne").name("\u5220\u9664\u52A8\u753B").onChange(r=>{this.remove(i.obs),e.removeFolder(s)})}clearOne(e){this.particleGroup.remove(e)}remove(e){e.panelsVisible==!0&&e.destroyPanel(),this.clearOne(e),e.dispose()}destroyPanel(){this.gui.destroy(),this.panelsVisible=!1}getSetting(){const e=this.particleGroup.length;for(let t=0;t<e;t++)this.particleAnimateData.push(this.particleGroup[t].exportDate())}applySetting(e,t){for(let i=0;i<e.length;i++){const s=new u(e[i]);this.addParticle(s),t?s.setParent(t):s.setParent(this.particleModelGroup)}}setParent(e){e&&e.add(this.particleModelGroup)}destroy(){this.particleModelGroup.traverse(t=>{t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose(),t=null});const e=this.particleModelGroup.parent;e.remove(this.particleModelGroup),this.particleModelGroup=null,this._initGroups(),e.add(this.particleModelGroup),this.particleGroup.splice(0,this.particleGroup.length),this.particleAnimateData.splice(0,this.particleAnimateData.length),this.particleNum=0}}export{c as P};
