(function(e){function t(t){for(var r,a,s=t[0],c=t[1],l=t[2],u=0,h=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},i=[];function a(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"23ba7d44"}[e]+".js"}function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=a(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,n[1](l)}o[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0d6c":function(e,t,n){},3158:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o={class:"common-layout"};function i(e,t,n,i,a,s){var c=Object(r["resolveComponent"])("el-header"),l=Object(r["resolveComponent"])("router-view"),u=Object(r["resolveComponent"])("el-main"),d=Object(r["resolveComponent"])("el-container"),h=Object(r["resolveComponent"])("Hovers");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",o,[Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(c,null,{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.demoTitle),1)]})),_:1}),Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,{class:"View3D"})]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1}),Object(r["createVNode"])(h,{class:"buts"})])}var a=n("5530"),s=n("9b64"),c=n.n(s),l=function(e){return Object(r["pushScopeId"])("data-v-0caedf99"),e=e(),Object(r["popScopeId"])(),e},u=Object(r["createTextVNode"])(" 打开 "),d=l((function(){return Object(r["createElementVNode"])("img",{src:c.a,alt:"ARdemo"},null,-1)})),h=l((function(){return Object(r["createElementVNode"])("br",null,null,-1)})),p=l((function(){return Object(r["createElementVNode"])("h4",null,"AR小房子",-1)})),f=l((function(){return Object(r["createElementVNode"])("br",null,null,-1)})),v=l((function(){return Object(r["createElementVNode"])("br",null,null,-1)})),b=l((function(){return Object(r["createElementVNode"])("br",null,null,-1)})),m=l((function(){return Object(r["createElementVNode"])("button",null,"VR案例",-1)}));function y(e,t,n,o,i,a){var s=Object(r["resolveComponent"])("el-button"),c=Object(r["resolveComponent"])("router-link"),l=Object(r["resolveComponent"])("el-drawer");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(s,{type:"primary",style:{"margin-left":"16px"},onClick:t[0]||(t[0]=function(e){return o.drawer=!0})},{default:Object(r["withCtx"])((function(){return[u]})),_:1}),Object(r["createVNode"])(l,{modelValue:o.drawer,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.drawer=e}),title:"导航","with-header":!0,direction:o.direction},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("span",null,[Object(r["createVNode"])(c,{to:"/"},{default:Object(r["withCtx"])((function(){return[d,h,p]})),_:1})]),f,v,b,Object(r["createElementVNode"])("span",null,[Object(r["createVNode"])(c,{to:"/VR"},{default:Object(r["withCtx"])((function(){return[m]})),_:1})])]})),_:1},8,["modelValue","direction"])])}var g={setup:function(){return{drawer:Object(r["ref"])(!1),direction:Object(r["ref"])("rtl")}}},w=(n("7828"),n("d959")),x=n.n(w);const R=x()(g,[["render",y],["__scopeId","data-v-0caedf99"]]);var j=R,O={name:"我的Vue页面",components:{Hovers:j},setup:function(){var e=Object(r["reactive"])({demoTitle:"AR房子",direction:"ltr"});return Object(a["a"])({},Object(r["toRefs"])(e))}};n("995e");const k=x()(O,[["render",i]]);var S=k,V=(n("d3b7"),n("3ca3"),n("ddb0"),n("6c02")),C=n("cf05"),E=n.n(C),A={class:"home"},M=Object(r["createElementVNode"])("img",{alt:"Vue logo",src:E.a},null,-1);function T(e,t,n,o,i,a){var s=Object(r["resolveComponent"])("HelloWorld");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",A,[M,Object(r["createVNode"])(s,{msg:"Welcome to Your Vue.js App"})])}var L={class:"hello"},B=Object(r["createStaticVNode"])('<p data-v-b9167eee> For a guide and recipes on how to configure / customize this project,<br data-v-b9167eee> check out the <a href="https://cli.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-cli documentation</a>. </p><h3 data-v-b9167eee>Installed CLI Plugins</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel" target="_blank" rel="noopener" data-v-b9167eee>babel</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint" target="_blank" rel="noopener" data-v-b9167eee>eslint</a></li></ul><h3 data-v-b9167eee>Essential Links</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Core Docs</a></li><li data-v-b9167eee><a href="https://forum.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Forum</a></li><li data-v-b9167eee><a href="https://chat.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>Community Chat</a></li><li data-v-b9167eee><a href="https://twitter.com/vuejs" target="_blank" rel="noopener" data-v-b9167eee>Twitter</a></li><li data-v-b9167eee><a href="https://news.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>News</a></li></ul><h3 data-v-b9167eee>Ecosystem</h3><ul data-v-b9167eee><li data-v-b9167eee><a href="https://router.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-router</a></li><li data-v-b9167eee><a href="https://vuex.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vuex</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/vue-devtools#vue-devtools" target="_blank" rel="noopener" data-v-b9167eee>vue-devtools</a></li><li data-v-b9167eee><a href="https://vue-loader.vuejs.org" target="_blank" rel="noopener" data-v-b9167eee>vue-loader</a></li><li data-v-b9167eee><a href="https://github.com/vuejs/awesome-vue" target="_blank" rel="noopener" data-v-b9167eee>awesome-vue</a></li></ul>',7);function P(e,t,n,o,i,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",L,[Object(r["createElementVNode"])("h1",null,Object(r["toDisplayString"])(n.msg),1),B])}var _={name:"HelloWorld",props:{msg:String}};n("8497");const N=x()(_,[["render",P],["__scopeId","data-v-b9167eee"]]);var H=N,U={name:"Home",components:{HelloWorld:H}};const D=x()(U,[["render",T]]);var G=D;function W(e,t,n,o,i,a){var s=Object(r["resolveComponent"])("TScene");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(s)])}var z={id:"WebGL",style:{width:"100%",height:"100%"}};function I(e,t,n,o,i,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",z)}var F=n("1da1"),q=(n("96cf"),n("b0c0"),n("d81d"),n("d4ec")),X=n("bee2"),Z=n("ade3"),J=(n("2b3d"),n("9861"),n("ac1f"),n("00b4"),n("5a89")),Y=n("ef20"),K=n("34ad"),Q=n("8710"),$=n("598d"),ee=n("4a8d"),te=n("4721"),ne=(n("5319"),function(){function e(){Object(q["a"])(this,e)}return Object(X["a"])(e,null,[{key:"createButton",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("button");function r(){if(void 0===t.domOverlay){var r=document.createElement("div");r.style.display="none",document.body.appendChild(r);var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width",38),o.setAttribute("height",38),o.style.position="absolute",o.style.right="20px",o.style.top="20px",o.addEventListener("click",(function(){a.end()})),r.appendChild(o);var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M 12,12 L 28,28 M 28,12 12,28"),i.setAttribute("stroke","#fff"),i.setAttribute("stroke-width",2),o.appendChild(i),void 0===t.optionalFeatures&&(t.optionalFeatures=[]),t.optionalFeatures.push("dom-overlay"),t.domOverlay={root:r}}var a=null;function s(e){return c.apply(this,arguments)}function c(){return c=Object(F["a"])(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o.addEventListener("end",l),e.xr.setReferenceSpaceType("local"),r.next=4,e.xr.setSession(o);case 4:he.EnterAR=!0,n.textContent="停止AR展示",t.domOverlay.root.style.display="",a=o;case 8:case"end":return r.stop()}}),r)}))),c.apply(this,arguments)}function l(){a.removeEventListener("end",l),n.textContent="点击进入AR",t.domOverlay.root.style.display="none",he.EnterAR=!1,a=null}n.style.display="",n.style.cursor="pointer",n.style.left="calc(50% - 50px)",n.style.width="100px",n.textContent="点击进入AR",n.onmouseenter=function(){n.style.opacity="1.0"},n.onmouseleave=function(){n.style.opacity="0.5"},n.onclick=function(){null===a?navigator.xr.requestSession("immersive-ar",t).then(s):a.end()}}function o(){n.style.display="",n.style.cursor="auto",n.style.left="calc(50% - 75px)",n.style.width="150px",n.onmouseenter=null,n.onmouseleave=null,n.onclick=null}function i(){o(),n.textContent="该设备环境不支持AR"}function a(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return n.id="ARButton",n.style.display="none",a(n),navigator.xr.isSessionSupported("immersive-ar").then((function(e){e?r():i()})).catch(i),n;var s=document.createElement("a");return!1===window.isSecureContext?(s.href=document.location.href.replace(/^http:/,"https:"),s.innerHTML="WEBXR需要HTTPS"):(s.href="https://immersiveweb.dev/",s.innerHTML="该设备暂不支持WebXR"),s.style.left="calc(50% - 90px)",s.style.width="180px",s.style.textDecoration="none",a(s),s}}]),e}()),re=n("cc82"),oe=function(){function e(){Object(q["a"])(this,e)}return Object(X["a"])(e,null,[{key:"createButton",value:function(e,t){t&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.');var n=document.createElement("button");function r(){var t=null;function r(e){return o.apply(this,arguments)}function o(){return o=Object(F["a"])(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o.addEventListener("end",i),he.EnterVR=!0,r.next=4,e.xr.setSession(o);case 4:n.textContent="EXIT VR",t=o;case 6:case"end":return r.stop()}}),r)}))),o.apply(this,arguments)}function i(){he.EnterVR=!1,t.removeEventListener("end",i),n.textContent="ENTER VR",t=null}n.style.display="",n.style.cursor="pointer",n.style.left="calc(50% - 50px)",n.style.width="100px",n.textContent="ENTER VR",n.onmouseenter=function(){n.style.opacity="1.0"},n.onmouseleave=function(){n.style.opacity="0.5"},n.onclick=function(){if(null===t){var e={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",e).then(r)}else t.end()}}function o(){n.style.display="",n.style.cursor="auto",n.style.left="calc(50% - 75px)",n.style.width="150px",n.onmouseenter=null,n.onmouseleave=null,n.onclick=null}function i(){o(),n.textContent="VR NOT SUPPORTED"}function a(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return n.id="VRButton",n.style.display="none",a(n),navigator.xr.isSessionSupported("immersive-vr").then((function(e){e?r():i()})),n;var s=document.createElement("a");return!1===window.isSecureContext?(s.href=document.location.href.replace(/^http:/,"https:"),s.innerHTML="WEBXR NEEDS HTTPS"):(s.href="https://immersiveweb.dev/",s.innerHTML="WEBXR NOT AVAILABLE"),s.style.left="calc(50% - 90px)",s.style.width="180px",s.style.textDecoration="none",a(s),s}}]),e}(),ie=n("0ca5"),ae=n("9a3e"),se=n("4b1d"),ce=n("32d9"),le=n("360d"),ue=n("93e9"),de=n("9ab2"),he={EnterAR:!1,hitTestSource:null,hitTestSourceRequested:!1,EnterVR:!1},pe=function(){function e(t){Object(q["a"])(this,e),Object(Z["a"])(this,"EnterAR",!1),Object(Z["a"])(this,"MoveCursor",!1),Object(Z["a"])(this,"materials",{}),Object(Z["a"])(this,"darkMaterial",new J["ab"]({color:"black"})),Object(Z["a"])(this,"intersected",[]),this.getContainer(t),this.initScene(),this.initRender(),this.initCamera(),this.initARCamera(),this.initControls(),this.initAmbLight(),this.EventListen(),this.Update()}return Object(X["a"])(e,[{key:"getContainer",value:function(e){var t=document.getElementById(e);return this.container=t}},{key:"initScene",value:function(){var e=new J["Ab"];return this.scene=e}},{key:"initRender",value:function(){var e=new J["Wb"]({antialias:!0,alpha:!0});return e.setSize(this.container.offsetWidth,this.container.offsetHeight),e.setPixelRatio(window.devicePixelRatio),this.container.appendChild(e.domElement),this.renders=e}},{key:"initCamera",value:function(){var e=new J["nb"](45,this.container.offsetWidth/this.container.offsetHeight,.1,1e3);return e.position.set(10,10,10),e.lookAt(0,0,0),this.scene.add(e),this.camera=e}},{key:"initARCamera",value:function(){var e=new J["nb"](45,this.container.offsetWidth/this.container.offsetHeight,.01,20);return this.scene.add(e),this.ARcamera=e}},{key:"initControls",value:function(){var e=new te["a"](this.camera,this.renders.domElement);return e.enableDamping=!0,this.control=e}},{key:"initState",value:function(){var e=new Y["a"];return this.container.appendChild(e.dom),this.state=e}},{key:"Update",value:function(){requestAnimationFrame(this.Update.bind(this)),0==he.EnterAR&&0==he.EnterVR&&(this.state&&this.state.update(),this.control.update(),1!=this.bloommodes?(this.renders.clear(),this.renders.render(this.scene,this.camera)):1==this.bloommodes&&this.UnrealBloomUpdate())}},{key:"EventListen",value:function(){window.addEventListener("resize",this.windowResize.bind(this))}},{key:"windowResize",value:function(){this.camera.aspect=this.container.offsetWidth/this.container.offsetHeight,this.camera.updateProjectionMatrix(),this.renders.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"initAmbLight",value:function(){var e=new J["c"]("#fff",.2);return this.scene.add(e),this.ambientLight=e}},{key:"axesHelper",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=new J["f"](e);return this.scene.add(t),this.axeshelper=t}},{key:"loadTexture",value:function(e){var t=(new J["Mb"]).load(e);return t}},{key:"loadSkyBox",value:function(e){var t=(new J["q"]).setPath(e).load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]);return t}},{key:"SetMaterial",value:function(e,t){if(e){var n=new J["eb"](e);return 1==t&&(n.side=J["u"]),n}}},{key:"addSpotlight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#fff",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=new J["Ib"](e,t);return 1==n&&(r.castShadow=!0),r}},{key:"AddHemisphereLight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0xfff",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0xfff",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=new J["D"](e,t,n);return r}},{key:"DracoLoaders",value:function(e){var t=new ie["a"];return t.setDecoderPath(e),t}},{key:"initRaycaster",value:function(){var e=new J["wb"];return this.raycaster=e}},{key:"TextModel",value:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=new ee["a"],null==r&&(r="./regular.json"),e.abrupt("return",new Promise((function(e){o.load(r,(function(r){var o=new $["a"](t,{font:r,size:30,height:1,curveSegments:5,bevelEnabled:!0,bevelThickness:5,bevelSize:2,bevelSegments:2}),i=new J["eb"](n),a=new J["Z"](o,i);a.castShadow=!0,e(a)}))})));case 3:case"end":return e.stop()}}),e)})));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"GetMixer",value:function(e){this.mixer=!0;var t=new J["e"](e);return t}},{key:"SetGroup",value:function(){var e=new J["C"];return e}},{key:"Clocks",value:function(){var e=new J["o"];return e}},{key:"LoadModel",value:function(e,t){return new Promise((function(n){var r=null;e.indexOf("gltf")>-1||e.indexOf("glb")>-1?(r=new K["a"],t&&r.setDRACOLoader(t),r.load(e,(function(e){e.scene.receiveShadow=!0,n(e)}))):e.indexOf("fbx")>-1&&(r=new Q["a"],r.load(e,(function(e){e.receiveShadow=!0,n(e)})))}))}},{key:"createBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:"#fff"},n=new J["j"](e,e,e),r=new J["eb"](t);r.side=J["u"];var o=new J["Z"](n,r);return o}},{key:"Vec3Obj",value:function(e,t,n){return new J["Sb"](e,t,n)}},{key:"Obj3D",value:function(){var e=new J["kb"];return e}},{key:"onSelects",value:function(){if(1==this.MoveCursor&&this.reticle.visible){var e=new J["s"](.1,.1,.2,32).translate(0,.1,0),t=new J["cb"]({color:16777215*Math.random()}),n=new J["Z"](e,t);n.position.setFromMatrixPosition(this.reticle.matrix),n.scale.y=2*Math.random()+1,this.scene.add(n)}}},{key:"addAREvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"select",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onSelects.bind(this);this.ARcontroller.addEventListener(e,(function(){t()}))}},{key:"ARreticle",value:function(){this.reticle=new J["Z"](new J["zb"](.15,.2,32).rotateX(-Math.PI/2),new J["ab"]),this.reticle.matrixAutoUpdate=!1,this.reticle.visible=!1,this.scene.add(this.reticle)}},{key:"ARmode",value:function(e){"移动光标"==e&&(this.MoveCursor=!0,this.ARreticle()),this.renders.xr.enabled=!0,this.container.appendChild(ne.createButton(this.renders,{requiredFeatures:["hit-test"]})),this.ARcontroller=this.renders.xr.getController(0),this.scene.add(this.ARcontroller),this.ARUpdate()}},{key:"ARUpdate",value:function(){this.renders.setAnimationLoop(this.ARDataUpdate.bind(this))}},{key:"ARDataUpdate",value:function(e,t){if(t){var n=this.renders.xr.getReferenceSpace(),r=this.renders.xr.getSession();if(0==he.hitTestSourceRequested&&(console.log(r,"数据s"),r.requestReferenceSpace("viewer").then((function(e){console.log(e,"创建数据"),r.requestHitTestSource({space:e}).then((function(e){console.log(e),he.hitTestSource=e}))})),r.addEventListener("end",(function(){he.hitTestSourceRequested=!1,he.hitTestSource=null})),he.hitTestSourceRequested=!0),he.hitTestSource){var o=t.getHitTestResults(he.hitTestSource);if(1==this.MoveCursor)if(o.length){var i=o[0];this.reticle.visible=!0,this.reticle.matrix.fromArray(i.getPose(n).transform.matrix)}else this.reticle.visible=!1}}1==he.EnterAR&&this.renders.render(this.scene,this.ARcamera)}},{key:"ARforApple",value:function(){this.renders.toneMapping=J["a"],this.renders.outputEncoding=J["Xb"];var e=new J["mb"](this.renders);this.scene.environment=e.fromScene(new se["a"],.04).texture,this.appleARExporter=new ae["a"]}},{key:"AppleARButton",value:function(e){var t=document.createElement("a");t.rel="ar",t.id="link",t.href="",t.download="asset.usdz",document.body.appendChild(t);var n=document.createElement("img");n.id="button",n.width="100",n.src="./arkit.png",t.appendChild(n),t.style.position="absolute",t.style.bottom="15px",t.style.left="calc(50%-40px)",t.href=URL.createObjectURL(e)}},{key:"ARMeshForApple",value:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.appleARExporter.parse(t);case 2:n=e.sent,r=new Blob([n],{type:"application/octet-stream"}),this.AppleARButton(r);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"CreateUV2",value:function(e){e.addAttribute("uv2",new J["l"](e.attributes.uv.array,2))}},{key:"EffectsPass",value:function(){var e=new ce["a"](this.renders);return this.effectcomposers=e}},{key:"EffectsPassResize",value:function(){this.effectcomposers.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"EffectsPass2",value:function(){var e=new ce["a"](this.renders);return this.effectcomposers2=e}},{key:"Effects2PassResize",value:function(){this.effectcomposers2.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"RenderScenePass",value:function(){var e=new ue["a"](this.scene,this.camera);return this.renderSceneComposer=e}},{key:"SceneShaderPASS",value:function(){var e=new J["Bb"]({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.effectcomposers.renderTarget2.texture}},vertexShader:"varying vec2 vUv;void main() {vUv = uv;gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );}",fragmentShader:"uniform sampler2D baseTexture;uniform sampler2D bloomTexture;varying vec2 vUv;void main() { gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) ); }"}),t=new le["a"](e,"baseTexture");return t.needsSwap=!0,this.Sceneshaderpass=t}},{key:"BloomLayer",value:function(){var e=new J["K"];return e.set(this.Bloom_Scene),this.bloom_Layer=e}},{key:"UnrealBloomMode",value:function(){this.bloommodes=!0,this.Init_Scene=0,this.Bloom_Scene=1,this.renders.toneMapping=J["xb"],this.EffectsPass(),this.EffectsPass2(),this.RenderScenePass(),this.BloomLayer(),this.bloomPass=new de["a"](new J["Rb"](this.container.offsetWidth,this.container.offsetHeight),1.5,.4,.85),this.bloomPass.threshold=0,this.bloomPass.strength=1.5,this.bloomPass.radius=0,this.effectcomposers.renderToScreen=!1,this.effectcomposers.addPass(this.renderSceneComposer),this.effectcomposers.addPass(this.bloomPass),this.SceneShaderPASS(),this.effectcomposers2.addPass(this.renderSceneComposer),this.effectcomposers2.addPass(this.Sceneshaderpass),this.UnrealBloomUpdate()}},{key:"UnrealBloomUpdate",value:function(){var e=this;this.scene&&this.scene.traverse((function(t){t.isMesh&&!1===e.bloom_Layer.test(t.layers)&&(e.materials[t.uuid]=t.material,t.material=e.darkMaterial)})),this.effectcomposers.render(),this.scene&&this.scene.traverse((function(t){e.materials[t.uuid]&&(t.material=e.materials[t.uuid],delete e.materials[t.uuid])})),this.effectcomposers2.render()}},{key:"BloomObjectAdd",value:function(e){e.layers.toggle(1)}},{key:"EnterVR",value:function(){this.renders.outputEncoding=J["Xb"],this.renders.xr.enabled=!0,this.container.appendChild(oe.createButton(this.renders)),this.initVRCamera(),this.initVRControl(),this.VRUpdate()}},{key:"initVRControl",value:function(){this.VRcontroller1=this.renders.xr.getController(0),this.VRcontroller1.addEventListener("selectstart",this.VROnSelectStart.bind(this)),this.VRcontroller1.addEventListener("selected",this.VROnSelectEnd.bind(this)),this.VRcontroller2=this.renders.xr.getController(1),this.VRcontroller2.addEventListener("selectstart",this.VROnSelectStart.bind(this)),this.VRcontroller2.addEventListener("selected",this.VROnSelectEnd.bind(this)),this.scene.add(this.VRcontroller1),this.scene.add(this.VRcontroller2),this.initVRChooseGroup(),this.initTempMatrix(),this.VRControlModel(),this.initRaycaster()}},{key:"VRControlModel",value:function(){var e=new re["a"];this.controllerGrip1=this.renders.xr.getControllerGrip(0),this.controllerGrip1.add(e.createControllerModel(this.controllerGrip1)),this.scene.add(this.controllerGrip1),this.controllerGrip2=this.renders.xr.getControllerGrip(1),this.controllerGrip2.add(e.createControllerModel(this.controllerGrip2)),this.scene.add(this.controllerGrip2),this.VRControlLine()}},{key:"VRControlLine",value:function(){var e=(new J["m"]).setFromPoints([new J["Sb"](0,0,0),new J["Sb"](0,0,-1)]),t=new J["L"](e);t.name="VRline",t.scale.z=5,this.controllerGrip1.add(t.clone()),this.controllerGrip2.add(t.clone())}},{key:"initTempMatrix",value:function(){this.tempMatrix=new J["Y"]}},{key:"initVRChooseGroup",value:function(){this.VRchooseGroup=this.SetGroup(),this.VRchooseGroup.name="可以被VR手柄选中的对象",this.scene.add(this.VRchooseGroup)}},{key:"initVRCamera",value:function(){this.VRCamera=new J["nb"](50,this.container.offsetWidth/this.container.offsetHeight,.1,10),this.VRCamera.position.set(0,1.6,3)}},{key:"VROnSelectStart",value:function(e){var t=e.target,n=this.getIntersections(t);if(n.length>0){var r=n[0],o=r.object;o.material.emissive.b=1,t.attach(o),t.userData.selected=o}}},{key:"VROnSelectEnd",value:function(e){var t=e.target;if(void 0!==t.userData.selected){var n=t.userData.selected;n.material.emissive.b=0,this.VRchooseGroup.attach(n),t.userData.selected=void 0}}},{key:"getIntersections",value:function(e){return this.tempMatrix.identity().extractRotation(e.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(e.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.tempMatrix),this.raycaster.intersectObjects(this.VRchooseGroup.children)}},{key:"ObjectBeChoose",value:function(e){if(void 0===e.userData.selected){var t=e.getObjectByName("VRline"),n=this.getIntersections(e);if(n.length>0){var r=n[0],o=r.object;o.material.emissive.r=1,this.intersected.push(o),t&&(t.scale.z=r.distance)}else t&&(t.scale.z=5)}}},{key:"ClearObjectBeChoose",value:function(){while(this.intersected.length){var e=this.intersected.pop();e.material.emissive.r=0}}},{key:"VRUpdate",value:function(){this.renders.setAnimationLoop(this.VRdataUpdate.bind(this))}},{key:"VRdataUpdate",value:function(){1==he.EnterVR&&(this.ClearObjectBeChoose(),this.ObjectBeChoose(this.VRcontroller1),this.ObjectBeChoose(this.VRcontroller2),this.renders.render(this.scene,this.VRCamera))}}]),e}(),fe=pe,ve={setup:function(){Object(r["onMounted"])((function(){var e=new fe("WebGL");e.camera.position.set(.35,.02,.07),e.camera.lookAt(0,-.1,-.2),e.control.target=e.Vec3Obj(0,-.1,-.2);var t=e.AddHemisphereLight();e.scene.add(t);var n=e.addSpotlight();n.position.y=1;var r=e.Obj3D();e.scene.add(r),r.position.set(0,0,-.2),n.target=r,e.scene.add(n);var o,i=e.createBox(.01,{color:"red"});function a(){return s.apply(this,arguments)}function s(){return s=Object(F["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.SetGroup(),n.name="无人机组",r=e.DracoLoaders("./draco/gltf/"),t.next=5,e.LoadModel("./resources/LittlestTokyo.glb",r);case 5:return i=t.sent,t.next=8,e.LoadModel("./resources/LittlestTokyoForApple.glb");case 8:a=t.sent,a.scene.scale.set(.1,.1,.1),i.scene.traverse((function(t){t.isMesh&&(t.material=e.SetMaterial({map:t.material.map,emissiveMap:t.material.emissiveMap,metalness:0,roughness:.2}))})),i.scene.rotation.y=Math.PI,i.scene.scale.set(.01,.01,.01),i.scene.position.set(0,.1,0),o=e.GetMixer(i.scene),a.scene.scale.set(.01,.01,.01),n.add(i.scene),n.scale.set(.02,.02,.02),n.position.set(0,-.1,-.2),e.scene.add(n),o.clipAction(i.animations[0]).play(),s=navigator.userAgent,s.indexOf("iPhone")>-1||s.indexOf("Mac")>-1?(e.ARforApple(),e.ARMeshForApple(a.scene)):(e.ARmode("移动光标"),e.addAREvent());case 23:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}i.position.set(0,0,-.2);var c=e.Clocks();function l(){requestAnimationFrame(l);var e=c.getDelta();o&&o.update(e)}l(),a()}))}};n("dbc9");const be=x()(ve,[["render",I],["__scopeId","data-v-50a1c204"]]);var me=be,ye={name:"AR小房子",components:{TScene:me}};n("7a20");const ge=x()(ye,[["render",W],["__scopeId","data-v-2804af8d"]]);var we=ge;function xe(e,t,n,o,i,a){var s=Object(r["resolveComponent"])("VRscene");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(s)])}var Re={id:"WebGL1",style:{width:"100%",height:"100%"}};function je(e,t,n,o,i,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Re)}var Oe=n("5c40"),ke={setup:function(){var e;Object(Oe["nb"])((function(){e=new fe("WebGL1"),e.axesHelper(),console.log(e.renders),e.EnterVR(),console.log(e)}))}};const Se=x()(ke,[["render",je]]);var Ve=Se,Ce={name:"VR小demo",components:{VRscene:Ve}};n("a03b");const Ee=x()(Ce,[["render",xe],["__scopeId","data-v-7a0dbf6c"]]);var Ae=Ee,Me=[{path:"/HOME",name:"Home",component:G},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}},{path:"/",name:"ARHouse",component:we},{path:"/VR",name:"VRdemo",component:Ae}],Te=Object(V["a"])({history:Object(V["b"])(),routes:Me}),Le=Te,Be=n("5502"),Pe=Object(Be["a"])({state:{},mutations:{},actions:{},modules:{}}),_e=n("c3a1");n("7437");Object(r["createApp"])(S).use(_e["a"]).use(Pe).use(Le).mount("#app")},"5d2a":function(e,t,n){},7828:function(e,t,n){"use strict";n("9e3d")},"7a20":function(e,t,n){"use strict";n("dc2e")},8497:function(e,t,n){"use strict";n("3158")},"995e":function(e,t,n){"use strict";n("b48b")},"9b64":function(e,t,n){e.exports=n.p+"img/ARhouse.18644a1d.png"},"9e3d":function(e,t,n){},a03b:function(e,t,n){"use strict";n("0d6c")},b48b:function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"},dbc9:function(e,t,n){"use strict";n("5d2a")},dc2e:function(e,t,n){}});
//# sourceMappingURL=app.e13facc4.js.map